CONTAINER_NAME = knative-hellonode
GCP_PROJECT = proj-genesis

all: clean build deploy

build:
	@echo "ðŸ”˜ Building '$(CONTAINER_NAME)' container..."
	docker build -t $(CONTAINER_NAME) .
	@echo "ðŸ”˜ Tagging '$(CONTAINER_NAME)' container..."
	docker tag $(CONTAINER_NAME) gcr.io/$(GCP_PROJECT)/$(CONTAINER_NAME):latest
	@echo "ðŸ”˜ Pushing '$(CONTAINER_NAME)' container..."
	docker push gcr.io/$(GCP_PROJECT)/$(CONTAINER_NAME):latest

run-docker:
	docker run -it -p 8080:8080 gcr.io/$(GCP_PROJECT)/$(CONTAINER_NAME):latest

run:
	npm start

deploy:
	@echo "ðŸ”˜ Deploying to cluster..."
	kubectl apply -f service.yaml

stop:
	@echo "ðŸ”˜ Removing from cluster..."
	kubectl delete -f service.yaml

clean:
	# @echo "ðŸ”˜ Cleaning workspace..."

.PHONY: build clean all